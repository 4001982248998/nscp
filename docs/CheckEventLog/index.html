<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>CheckEventLog</title>
<link rel="stylesheet" type="text/css" href="../nscplus.css">
<base target="_self">
</head>

<body>

<div id="content" class="documentContent">
	<h1>CheckEventLog.dll</h1>
	<p>The CheckEventLog module checks for problems reported to the windows event log.</p>
	<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" id="table4">
		<tr>
			<th valign="top">Command </th>
			<th valign="top">Description </th>
		</tr>
		<tr>
			<td valign="top">CheckEventLog </td>
			<td valign="top">Check to fins errors in the event log.</td>
		</tr>
		</table>
	<h2>Configuration</h2>
	<p><i>This module has no configuration directives.</i></p>
	<h2>CheckEventLog</h2>
	<p>This check enumerates all event in the event log and filters out (or in) 
	events and then the resulting list is used to determine state.</p>
	<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" id="table5">
		<tr>
			<th valign="top">Option </th>
			<th valign="top">Values </th>
			<th valign="top">Description </th>
		</tr>
		<tr>
			<td valign="top">file</td>
			<td valign="top">A event log file name</td>
			<td valign="top">The name of an eventlog file the default ones are 
			Application, Security and System.</td>
		</tr>
		<tr>
			<td valign="top">filter</td>
			<td valign="top">in, out, any, all</td>
			<td valign="top">Specify the way you want to filter things.<p><b>in</b> 
			means any thing matching this filter will be included in the result.</p>
			<p><b>out</b> means any thing matching this filter will be excluded 
			from the result.</p>
			<p><b>any</b> means any of the filter rules has to match.</p>
			<p><b>all</b> means all of the filter rules have to match.</p>
			<p>Thus filter=all filter=in and filter=any filter=out is the 
			combinations that makes the most sence depending on your filter 
			concept.</td>
		</tr>
		<tr>
			<td valign="top">descriptions</td>
			<td valign="top"><i>None</i></td>
			<td valign="top">Flag to specify if you want to include string 
			representation of the error messages.</td>
		</tr>
		<tr>
			<td valign="top">truncate</td>
			<td valign="top">length of the returned set</td>
			<td valign="top">This will truncate the output after the specified 
			length. As NRPE can only handle 1024 chars you need to truncate the 
			output.</td>
		</tr>
		<tr>
			<td valign="top">MaxWarn</td>
			<td valign="top">number of records</td>
			<td valign="top">The maximum records to allow before reporting a 
			warning state.</td>
		</tr>
		<tr>
			<td valign="top">MaxCrit</td>
			<td valign="top">number of records</td>
			<td valign="top">The maximum records to allow before reporting a 
			critical state.</td>
		</tr>
		<tr>
			<td valign="top">
			filter-eventType</td>
			<td valign="top">
			error, warning, etc</td>
			<td valign="top">
			An event type to filter out: error, warning, info, auditSuccess or 
			auditFailure.</td>
		</tr>
		<tr>
			<td valign="top">
			filter-eventSource</td>
			<td valign="top">
			string expression</td>
			<td valign="top">
			The name of the source of the event. Can be a substring or 
			regularexpression</td>
		</tr>
		<tr>
			<td valign="top">
			filter-generated</td>
			<td valign="top">
			time expression</td>
			<td valign="top">
			Time ago the message was generated</td>
		</tr>
		<tr>
			<td valign="top">
			filter-written</td>
			<td valign="top">
			time expression</td>
			<td valign="top">
			Time ago the message was written to the log</td>
		</tr>
		<tr>
			<td valign="top">
			filter-message</td>
			<td valign="top">
			string expression</td>
			<td valign="top">
			Filter strings in the message. Can be a substring or 
			regularexpression</td>
		</tr>
	</table>
	<p>&nbsp;</p>
	<p>A time expression is a date/time interval as a number prefixed by a 
	filter prefix (&lt;, &gt;, =, !=) and followed by a unit postfix (m, s, h, d, w). 
	A few examples of time expression are: filter-generated=&gt;2d means filter 
	will match any records older than 2 days, filter-generated=&lt;2h means match 
	any records newver then 2 hours.</p>
	<p>A string expression is a key followed by a string that specifies a string 
	expression. Currently substr and regexp are supported. Thus you enter 
	filter-message=regexp:(foo|bar) to enter a regular expression and 
	filter-message=substr:foo to enter a substring patter match.</p>
	<h3>Examples</h3>
	<div class="example">
		<ul>
			<li>
			<p><b>Check the Application event log for errors in the 
			last 48 hours. Filter out any Cdrom and NSClient errors as well as 
			all warnings. Allow 3 errors before a warning is issued and 7 before 
			a critical state.</b></p>
			<p><code>checkEventLog file=system file=application 
			MaxWarn=1 MaxCrit=1 filter-generated=&gt;2d filter-eventSource=substr:Service 
			filter-eventSource=substr:Tcpip filter=out filter=any</code></p>
			<p><code>CRITICAL: 27 > critical: ESENT, ESENT, ESENT, ESENT,...</code></p>
			<div class="config">
				<p>define command { </p>
				<p>&nbsp;&nbsp;&nbsp; command_name check_event_log </p>
				<p>&nbsp;&nbsp;&nbsp; command_line check_nrpe -H $HOSTADDRESS$ -p 
				5666 -c checkEventLog -a file=system file=application MaxWarn=1 MaxCrit=1 
			filter-generated=&gt;2d filter-eventSource=substr:Service 
			filter-eventSource=substr:Tcpip filter=out filter=any</p>
				<p>}</p>
				<p>&nbsp;&nbsp;&nbsp; check_command check_event_log
				</p>
			</div>
			</li>
		</ul>
	</div>
</div>

</body>

</html>