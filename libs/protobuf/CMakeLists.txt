cmake_minimum_required(VERSION 2.6)

WRAP_PROTO(PROTO_PLUGIN_SRC plugin.proto)
WRAP_PROTO(PROTO_LOG_SRC log.proto)
WRAP_PROTO(PROTO_EXEC_SRC exec.proto)
WRAP_PROTO(PROTO_SETTINGS_SRC settings.proto)

SET(TARGET protobuf)

SET(SRCS
	plugin.proto
	log.proto
	exec.proto
	settings.proto
	
	${PROTO_PLUGIN_SRC}
	${PROTO_LOG_SRC}
	${PROTO_EXEC_SRC}
	${PROTO_SETTINGS_SRC}
)

add_library(${TARGET} ${SRCS})
SET_TARGET_PROPERTIES(${TARGET} PROPERTIES FOLDER "libraries")

target_link_libraries(${TARGET}
	${PROTOBUF_LIBRARY}
)
IF(CMAKE_COMPILER_IS_GNUCXX)
	IF("${CMAKE_SYSTEM_PROCESSOR}" STREQUAL "x86_64" AND NOT APPLE)
		SET_TARGET_PROPERTIES(${TARGET} PROPERTIES COMPILE_FLAGS -fPIC)
	ENDIF("${CMAKE_SYSTEM_PROCESSOR}" STREQUAL "x86_64" AND NOT APPLE)
ENDIF(CMAKE_COMPILER_IS_GNUCXX)
