cmake_minimum_required(VERSION 2.6)
IF(WIN32)
	PROJECT(NSCPDOTNET)

	SET(SRCS
		AssemblyInfo.cpp
		NSCP.h
		stdafx.cpp
		stdafx.h
	)

	#ADD_DEFINITIONS(${NSCP_GLOBAL_DEFINES})

	STRING(REPLACE "/EHsc" "/EHa" CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS}")
	STRING(REPLACE "/EHs" "/EHa" CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS}")
	STRING(REPLACE "/MT" "/MD" CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS}")
	STRING(REPLACE "/EHsc" "/EHa" CMAKE_CXX_FLAGS_RELWITHDEBINFO ${CMAKE_CXX_FLAGS_RELWITHDEBINFO})
	STRING(REPLACE "/EHs" "/EHa" CMAKE_CXX_FLAGS_RELWITHDEBINFO ${CMAKE_CXX_FLAGS_RELWITHDEBINFO})
	STRING(REPLACE "/MT" "/MD" CMAKE_CXX_FLAGS_RELWITHDEBINFO ${CMAKE_CXX_FLAGS_RELWITHDEBINFO})
	STRING(REPLACE "/MT" "/MD" CMAKE_CXX_FLAGS_MINSIZEREL ${CMAKE_CXX_FLAGS_MINSIZEREL})
	STRING(REPLACE "/MT" "/MD" CMAKE_CXX_FLAGS_RELEASE ${CMAKE_CXX_FLAGS_RELEASE})
	STRING(REPLACE "/EHsc" "/EHa" CMAKE_CXX_FLAGS_DEBUG ${CMAKE_CXX_FLAGS_DEBUG})
	STRING(REPLACE "/EHs" "/EHa" CMAKE_CXX_FLAGS_DEBUG ${CMAKE_CXX_FLAGS_DEBUG})
	STRING(REPLACE "/MTd" "/MDd" CMAKE_CXX_FLAGS_DEBUG ${CMAKE_CXX_FLAGS_DEBUG})
	STRING(REPLACE "/RTC1" "" CMAKE_CXX_FLAGS_DEBUG ${CMAKE_CXX_FLAGS_DEBUG})
	STRING(REPLACE "/RTCs" "" CMAKE_CXX_FLAGS_DEBUG ${CMAKE_CXX_FLAGS_DEBUG})
	STRING(REPLACE "/RTCu" "" CMAKE_CXX_FLAGS_DEBUG ${CMAKE_CXX_FLAGS_DEBUG})
	STRING(REPLACE "/GZ" "" CMAKE_CXX_FLAGS_DEBUG ${CMAKE_CXX_FLAGS_DEBUG})
	SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /clr /EHa")
	
	ADD_LIBRARY(NSCPDOTNET MODULE ${SRCS})

	MESSAGE(STATUS "Building NSCPDOTNET into ${BUILD_TARGET_EXE_PATH}")
	SET_TARGET_PROPERTIES(NSCPDOTNET PROPERTIES 
		FOLDER "libraries"
		LIBRARY_OUTPUT_DIRECTORY "${BUILD_TARGET_EXE_PATH}"
		ARCHIVE_OUTPUT_DIRECTORY "${BUILD_TARGET_EXE_PATH}"
		)

if (MSVC11)
	SET_TARGET_PROPERTIES(NSCPDOTNET PROPERTIES 
		LIBRARY_OUTPUT_DIRECTORY ${BUILD_TARGET_EXE_PATH}
		LIBRARY_OUTPUT_DIRECTORY_DEBUG ${BUILD_TARGET_EXE_PATH}
		LIBRARY_OUTPUT_DIRECTORY_RELEASE ${BUILD_TARGET_EXE_PATH}
		LIBRARY_OUTPUT_DIRECTORY_RELWITHDEBINFO ${BUILD_TARGET_EXE_PATH}
	)
endif(MSVC11)

	INSTALL(TARGETS NSCPDOTNET LIBRARY DESTINATION .)
ENDIF(WIN32)
