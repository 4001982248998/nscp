CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

SET(TARGET main_dll)
	
PROJECT(${TARGET})

SET(SRCS
	${TARGET}.cpp
	${NSCP_INCLUDEDIR}/ServiceCmd.cpp

)

ADD_DEFINITIONS(${NSCP_GLOBAL_DEFINES})

IF(WIN32)
	SET(SRCS ${SRCS}
		"${TARGET}.def"
		installer_helper.hpp
		${NSCP_INCLUDEDIR}/ServiceCmd.h
	)
ENDIF(WIN32)

INCLUDE_DIRECTORIES(${PSDK_2003_INCLUDE_DIRS})
#LINK_DIRECTORIES(${PSDK_2003_LIBRARY_DIRS})

ADD_LIBRARY(${TARGET} MODULE ${SRCS})

TARGET_LINK_LIBRARIES(${TARGET}
	${Boost_FILESYSTEM_LIBRARY}
	${Boost_SYSTEM_LIBRARY}
	Msi.lib
	bufferoverflowu.lib
)

SET_TARGET_PROPERTIES(${TARGET} PROPERTIES FOLDER "installer-dll")

INSTALL(TARGETS ${TARGET} LIBRARY DESTINATION helpers)
